<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Criação - Ordem dos Dias</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #1c1c1c;
      color: white;
      overflow-x: hidden;
    }

    h1 {
      font-size: 24px;
      margin: 10px 0 5px;
      text-align: center;
    }

    #pares-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      padding: 10px;
    }

    .linha {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .card, .dropzone {
      width: 160px;
      min-height: 200px;
      border: 2px dashed #ccc;
      border-radius: 12px;
      background-color: #333;
      text-align: center;
      padding: 10px;
      color: white;
      font-size: 14px;
      box-sizing: border-box;
      flex-shrink: 0;
    }

    .card {
      cursor: grab;
      background-color: #2e2e2e;
      border: 2px solid #1e90ff;
      position: relative;
    }

    .card img {
      width: 100%;
      height: 60%;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .dropzone.over {
      background-color: rgba(255, 255, 255, 0.2);
    }

    #resultado {
      margin-top: 15px;
      font-size: 18px;
      font-weight: bold;
      color: #00ff99;
      text-align: center;
    }

    #resultado.acertou {
      animation: pulse 1s ease-in-out 3;
      background: linear-gradient(90deg, #fff700, #00ffcc);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .piscar-card {
      animation: piscar-card 0.6s ease-in-out 2;
      border-color: red;
    }

    @keyframes piscar-card {
      0%, 100% { background-color: transparent; }
      50% { background-color: rgba(255, 0, 0, 0.2); }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    .touch-dragging {
      position: fixed;
      z-index: 1000;
      pointer-events: none;
      background-color: #2e2e2e;
      border: 2px solid #1e90ff;
      border-radius: 12px;
      padding: 10px;
      box-sizing: border-box;
      color: white;
      font-size: 14px;
      text-align: center;
      width: 160px;
      min-height: 200px;
      transform: translate(-50%, -50%);
    }

    .touch-dragging img {
      width: 100%;
      height: 60%;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 6px;
    }

    body.touching {
      overflow: hidden;
      touch-action: none;
    }
  </style>
</head>
<body>
  <h1>Organize os Dias da Criação</h1>
  <div id="pares-container"></div>
  <div id="resultado"></div>

  <script>
    const cardsData = [
      { dia: "1", texto: "Haja luz", img: "../img/card_dia1.png" },
      { dia: "2", texto: "Firmamento no meio das águas", img: "../img/card_dia2.png" },
      { dia: "3", texto: "Apareça a porção seca", img: "../img/card_dia3.png" },
      { dia: "4", texto: "Sol, lua e estrelas", img: "../img/card_dia4.png" },
      { dia: "5", texto: "Criou os peixes e as aves", img: "../img/card_dia5.png" },
      { dia: "6", texto: "Animais e o homem", img: "../img/card_dia6.png" },
      { dia: "7", texto: "Deus descansou", img: "../img/card_dia7.png" }
    ];

    const paresContainer = document.getElementById('pares-container');

    cardsData.sort(() => Math.random() - 0.5).forEach(data => {
      const linha = document.createElement('div');
      linha.className = 'linha';

      const dropzone = document.createElement('div');
      dropzone.className = 'dropzone';
      dropzone.dataset.ordem = data.dia;
      dropzone.innerText = `Dia ${data.dia}`;

      const card = document.createElement('div');
      card.className = 'card';
      card.draggable = true;
      card.dataset.dia = data.dia;
      card.innerHTML = `<img src="${data.img}" alt="Imagem do dia"><div>${data.texto}</div>`;
      addCardListeners(card);

      linha.appendChild(dropzone);
      linha.appendChild(card);
      paresContainer.appendChild(linha);
    });

    function addCardListeners(card) {
      card.addEventListener('dragstart', e => {
        e.dataTransfer.setData('text/plain', card.dataset.dia);
        e.dataTransfer.setDragImage(card, 0, 0);
        card.classList.add('dragging');
      });
      card.addEventListener('dragend', () => card.classList.remove('dragging'));
    }

    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.dropzone').forEach(zone => {
        zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('over'); });
        zone.addEventListener('dragleave', () => zone.classList.remove('over'));
        zone.addEventListener('drop', e => {
          e.preventDefault();
          const dia = e.dataTransfer.getData('text/plain');
          const dragged = document.querySelector(`.card[data-dia='${dia}']`);
          if (dragged) {
            const existing = zone.parentElement.querySelector('.card');
            if (existing) paresContainer.appendChild(existing.parentElement);
            zone.innerHTML = `Dia ${zone.dataset.ordem}`;
            zone.parentElement.appendChild(dragged);
            addCardListeners(dragged);
            verificarOrdem();
          }
          zone.classList.remove('over');
        });
      });
    });

    function verificarOrdem() {
      let correto = true;
      document.querySelectorAll('.dropzone').forEach(zone => {
        const card = zone.parentElement.querySelector('.card');
        if (!card || card.dataset.dia !== zone.dataset.ordem) {
          correto = false;
          if (card) {
            card.classList.add('piscar-card');
            setTimeout(() => card.classList.remove('piscar-card'), 1200);
          }
        }
      });

      const resultado = document.getElementById('resultado');
      if (correto) {
        resultado.textContent = 'Parabéns! Você organizou corretamente os dias da criação! ✅';
        resultado.classList.add('acertou');
      } else {
        resultado.textContent = 'Ainda não está certo. Tente novamente! ❌';
        resultado.classList.remove('acertou');
        resultado.style.color = '#ff5555';
      }
    }

    // SUPORTE A TOQUE
    let tocando = false;
    let elementoTocado = null;

    document.addEventListener("touchstart", e => {
      const target = e.target.closest(".card");
      if (target) {
        e.preventDefault();
        document.body.classList.add("touching");
        tocando = true;
        elementoTocado = target.cloneNode(true);
        elementoTocado.classList.add("touch-dragging");
        elementoTocado.dataset.dia = target.dataset.dia;
        elementoTocado.id = "dragging-temp";
        document.body.appendChild(elementoTocado);
      }
    });

    document.addEventListener("touchmove", e => {
      if (tocando && elementoTocado) {
        e.preventDefault();
        const touch = e.touches[0];
        elementoTocado.style.left = `${touch.clientX}px`;
        elementoTocado.style.top = `${touch.clientY}px`;
      }
    });

    document.addEventListener("touchend", e => {
      if (tocando && elementoTocado) {
        const touch = e.changedTouches[0];
        const x = touch.clientX;
        const y = touch.clientY;

        document.querySelectorAll(".dropzone").forEach(dz => {
          const rect = dz.getBoundingClientRect();
          if (x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom) {
            const dia = elementoTocado.dataset.dia;
            const dragged = document.querySelector(`.card[data-dia='${dia}']`);
            const existing = dz.parentElement.querySelector('.card');
            if (existing) paresContainer.appendChild(existing.parentElement);
            dz.innerHTML = `Dia ${dz.dataset.ordem}`;
            dz.parentElement.appendChild(dragged);
            addCardListeners(dragged);
            verificarOrdem();
          }
        });

        document.getElementById("dragging-temp")?.remove();
        elementoTocado.remove();
        elementoTocado = null;
        tocando = false;
        document.body.classList.remove("touching");
      }
    });
  </script>
</body>
</html>
