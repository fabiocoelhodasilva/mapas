<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Criação - Ordem dos Dias</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #1c1c1c;
      color: white;
      overflow-x: hidden;
      overscroll-behavior: contain;
    }

    h1 {
      font-size: 24px;
      margin: 10px 0 5px;
      text-align: center;
    }

    .mobile-flex {
      display: flex;
      gap: 10px;
      justify-content: center;
      width: 100%;
      flex-wrap: wrap;
    }

    #cards-container {
      touch-action: none;
      user-select: none;
    }

    #cards-container, #dropzones-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
    }

    .card, .dropzone {
      width: 160px;
      min-height: 200px;
      border: 2px dashed #ccc;
      border-radius: 12px;
      background-color: #333;
      text-align: center;
      padding: 10px;
      color: white;
      font-size: 14px;
      box-sizing: border-box;
      flex-shrink: 0;
    }

    .card {
      cursor: grab;
      background-color: #2e2e2e;
      border: 2px solid #1e90ff;
      position: relative;
    }

    .card img {
      width: 100%;
      height: 70%;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .dropzone.over {
      background-color: rgba(255, 255, 255, 0.2);
    }

    #resultado {
      margin-top: 15px;
      font-size: 18px;
      font-weight: bold;
      color: #00ff99;
      text-align: center;
    }

    #resultado.acertou {
      animation: pulse 1s ease-in-out 3;
      background: linear-gradient(90deg, #fff700, #00ffcc);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .piscar-card {
      animation: piscar-card 0.6s ease-in-out 2;
      border-color: red;
    }

    @keyframes piscar-card {
      0%, 100% { background-color: transparent; }
      50% { background-color: rgba(255, 0, 0, 0.2); }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    .touch-dragging {
      position: fixed;
      z-index: 1000;
      pointer-events: none;
      background-color: #2e2e2e;
      border: 2px solid #1e90ff;
      border-radius: 12px;
      padding: 10px;
      box-sizing: border-box;
      color: white;
      font-size: 14px;
      text-align: center;
      width: 160px;
      min-height: 100px;
      transform: translate(-50%, -50%);
    }

    .touch-dragging img {
      width: 100%;
      height: 50px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 6px;
    }

    body.touching {
      overflow: hidden;
      touch-action: none;
    }

    @media screen and (max-width: 600px) {
      .mobile-flex {
        flex-direction: row;
        gap: 6%;
        padding: 0 6px;
      }

      #dropzones-container, #cards-container {
        flex-direction: column;
        align-items: center;
        width: 43%;
      }

      .card, .dropzone {
        width: 90%;
        min-height: 80px;
      }

      .card img,
      .touch-dragging img {
        height: 40px;
      }

      .touch-dragging {
        width: 90%;
        min-height: 80px;
      }
    }
  </style>
</head>
<body>
  <h1>Organize os Dias da Criação</h1>
  <div class="mobile-flex">
    <div id="dropzones-container"></div>
    <div id="cards-container"></div>
  </div>
  <div id="resultado"></div>

  <script>
    const cardsData = [
      { dia: "1", texto: "Haja luz", img: "../img/card_dia1.png" },
      { dia: "2", texto: "Firmamento no meio das águas", img: "../img/card_dia2.png" },
      { dia: "3", texto: "Apareça a porção seca", img: "../img/card_dia3.png" },
      { dia: "4", texto: "Sol, lua e estrelas", img: "../img/card_dia4.png" },
      { dia: "5", texto: "Criou os peixes e as aves", img: "../img/card_dia5.png" },
      { dia: "6", texto: "Animais e o homem", img: "../img/card_dia6.png" },
      { dia: "7", texto: "Deus descansou", img: "../img/card_dia7.png" }
    ];

    const container = document.getElementById('cards-container');
    const dropzonesContainer = document.getElementById('dropzones-container');

    for (let i = 1; i <= 7; i++) {
      const zone = document.createElement('div');
      zone.className = 'dropzone';
      zone.dataset.ordem = i.toString();
      zone.innerText = `Dia ${i}`;
      dropzonesContainer.appendChild(zone);
    }

    cardsData.sort(() => Math.random() - 0.5).forEach(data => {
      const div = document.createElement('div');
      div.className = 'card';
      div.draggable = true;
      div.dataset.dia = data.dia;
      div.innerHTML = `<img src="${data.img}" alt="Imagem do dia"><div>${data.texto}</div>`;
      container.appendChild(div);
    });

    function addCardListeners(card) {
      card.addEventListener('dragstart', e => {
        e.dataTransfer.setData('text/plain', card.dataset.dia);
        e.dataTransfer.setDragImage(card, 0, 0);
        card.classList.add('dragging');
      });
      card.addEventListener('dragend', () => card.classList.remove('dragging'));
    }

    document.querySelectorAll('.card').forEach(addCardListeners);

    document.querySelectorAll('.dropzone').forEach(zone => {
      zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('over'); });
      zone.addEventListener('dragleave', () => zone.classList.remove('over'));
      zone.addEventListener('drop', e => {
        e.preventDefault();
        const dia = e.dataTransfer.getData('text/plain');
        const dragged = document.querySelector(`.card[data-dia='${dia}']`);
        if (dragged) {
          const existing = zone.querySelector('.card');
          if (existing) container.appendChild(existing);
          zone.innerHTML = `Dia ${zone.dataset.ordem}`;
          zone.appendChild(dragged);
          addCardListeners(dragged);
          verificarOrdem();
        }
        zone.classList.remove('over');
      });
    });

    function verificarOrdem() {
      let correto = true;
      document.querySelectorAll('.dropzone').forEach(zone => {
        const card = zone.querySelector('.card');
        if (!card || card.dataset.dia !== zone.dataset.ordem) {
          correto = false;
          if (card) {
            card.classList.add('piscar-card');
            setTimeout(() => card.classList.remove('piscar-card'), 1200);
          }
        }
      });

      const resultado = document.getElementById('resultado');
      if (correto) {
        resultado.textContent = 'Parabéns! Você organizou corretamente os dias da criação! ✅';
        resultado.classList.add('acertou');
      } else {
        resultado.textContent = 'Ainda não está certo. Tente novamente! ❌';
        resultado.classList.remove('acertou');
        resultado.style.color = '#ff5555';
      }
    }

    // TOUCH SUPPORT
    let tocando = false;
    let elementoTocado = null;

    document.addEventListener("touchstart", e => {
      const target = e.target.closest(".card");
      if (target) {
        e.preventDefault();
        document.body.classList.add("touching");
        tocando = true;
        elementoTocado = target.cloneNode(true);
        elementoTocado.classList.add("touch-dragging");
        elementoTocado.dataset.dia = target.dataset.dia;
        elementoTocado.id = "dragging-temp";
        document.body.appendChild(elementoTocado);
      }
    });

    document.addEventListener("touchmove", e => {
      if (tocando && elementoTocado) {
        e.preventDefault();
        const touch = e.touches[0];
        elementoTocado.style.left = `${touch.clientX}px`;
        elementoTocado.style.top = `${touch.clientY}px`;
      }
    });

    document.addEventListener("touchend", e => {
      if (tocando && elementoTocado) {
        const touch = e.changedTouches[0];
        const x = touch.clientX;
        const y = touch.clientY;

        document.querySelectorAll(".dropzone").forEach(dz => {
          const rect = dz.getBoundingClientRect();
          if (x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom) {
            const dia = elementoTocado.dataset.dia;
            const dragged = document.querySelector(`.card[data-dia='${dia}']`);
            const existing = dz.querySelector('.card');
            if (existing) container.appendChild(existing);
            dz.innerHTML = `Dia ${dz.dataset.ordem}`;
            dz.appendChild(dragged);
            addCardListeners(dragged);
            verificarOrdem();
          }
        });

        document.getElementById("dragging-temp")?.remove();
        elementoTocado.remove();
        elementoTocado = null;
        tocando = false;
        document.body.classList.remove("touching");
      }
    });
  </script>
</body>
</html>
